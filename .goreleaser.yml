# GoReleaser é…ç½®æ–‡ä»¶
# æ–‡æ¡£: https://goreleaser.com

version: 2

# é¡¹ç›®åŸºæœ¬ä¿¡æ¯
project_name: gpd-touch-fix

# æ„å»ºé…ç½®
builds:
  - id: gpd-touch-fix
    main: .
    binary: gpd-touch-fix
    
    # ç¼–è¯‘æ ‡å¿— - æ³¨å…¥ç‰ˆæœ¬ä¿¡æ¯
    ldflags:
      - -s -w
      - -X main.Version={{.Version}}
      - -X main.GitCommit={{.ShortCommit}}
      - -X main.BuildTime={{.Date}}
    
    # ç¯å¢ƒå˜é‡
    env:
      - CGO_ENABLED=0
    
    # ç›®æ ‡å¹³å°
    goos:
      - windows
    
    goarch:
      - amd64  # 64ä½
    
    # æ„å»ºé’©å­ï¼ˆå¯é€‰ï¼‰
    hooks:
      post: |
        {{- if eq .Os "windows" }}
        cmd /c echo "Built {{.Path}} for {{.Os}}/{{.Arch}}"
        {{- else }}
        echo "Built {{.Path}} for {{.Os}}/{{.Arch}}"
        {{- end }}

# å½’æ¡£é…ç½®
archives:
  - id: default
    name_template: >-
      {{ .ProjectName }}-
      {{- .Version }}-
      {{- if eq .Arch "amd64" }}windows-x64
      {{- else if eq .Arch "386" }}windows-x86
      {{- else }}{{ .Os }}-{{ .Arch }}{{ end }}
    
    # å½’æ¡£æ ¼å¼
    formats: [zip]
    
    # åŒ…å«çš„æ–‡ä»¶
    files:
      - config.example.json
      - README.md
      - LICENSE
      - CHANGELOG.md

# Checksum æ–‡ä»¶
checksum:
  name_template: 'checksums.txt'
  algorithm: sha256

# Changelog é…ç½®
changelog:
  use: github
  
  # æ’åº
  sort: asc
  
  # æäº¤åˆ†ç»„
  groups:
    - title: ğŸš€ æ–°åŠŸèƒ½
      regexp: '^.*?feat(\([[:word:]]+\))??!?:.+$'
      order: 0
    - title: ğŸ› Bug ä¿®å¤
      regexp: '^.*?fix(\([[:word:]]+\))??!?:.+$'
      order: 1
    - title: ğŸ“ æ–‡æ¡£æ›´æ–°
      regexp: '^.*?docs?(\([[:word:]]+\))??!?:.+$'
      order: 2
    - title: ğŸ”§ å…¶ä»–æ”¹è¿›
      order: 999
  
  # è¿‡æ»¤æäº¤
  filters:
    exclude:
      - '^test:'
      - '^chore:'
      - '^ci:'
      - 'merge conflict'
      - Merge pull request
      - Merge remote-tracking branch
      - Merge branch

# GitHub Release é…ç½®
release:
  github:
    owner: taliove
    name: gpd-touch-fix
  
  # Release åç§°æ¨¡æ¿
  name_template: "v{{.Version}}"
  
  # é¢„å‘å¸ƒåˆ¤æ–­
  prerelease: auto
  
  # è‰ç¨¿æ¨¡å¼ï¼ˆå¦‚æœå¸Œæœ›æ‰‹åŠ¨å®¡æ ¸åå‘å¸ƒï¼Œè®¾ä¸º trueï¼‰
  draft: false
  
  # æ›¿æ¢ç°æœ‰ releaseï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
  replace_existing_draft: true
  
  # åœ¨ release æè¿°ä¸­åŒ…å«çš„é¢å¤–ä¿¡æ¯
  header: |
    ## GPD è§¦å±è‡ªåŠ¨ä¿®å¤å·¥å…· - v{{.Version}}
    
    ### ğŸ“¦ ä¸‹è½½è¯´æ˜
    
    - **64ä½ç³»ç»Ÿ**: ä¸‹è½½ `gpd-touch-fix-{{.Version}}-windows-x64.zip`
    - **32ä½ç³»ç»Ÿ**: ä¸‹è½½ `gpd-touch-fix-{{.Version}}-windows-x86.zip`
    
    ### ğŸš€ å¿«é€Ÿå¼€å§‹
    
    1. ä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„ ZIP åŒ…å¹¶è§£å‹
    2. å³é”® `gpd-touch-fix.exe` é€‰æ‹©"ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"
    3. æ‰§è¡Œå®‰è£…å‘å¯¼ï¼š`.\gpd-touch-fix.exe --setup`
    
    å®Œæ•´æ–‡æ¡£è¯·å‚é˜… [README.md](https://github.com/gpd-touch/gpd-touch-fix#readme)
    
  footer: |
    ---
    
    **éªŒè¯ä¸‹è½½æ–‡ä»¶å®Œæ•´æ€§**
    
    å¯ä»¥ä½¿ç”¨ `checksums.txt` æ–‡ä»¶éªŒè¯ä¸‹è½½æ–‡ä»¶çš„å®Œæ•´æ€§ï¼š
    
    ```powershell
    # PowerShell ä¸­éªŒè¯ SHA256
    (Get-FileHash .\gpd-touch-fix-{{.Version}}-windows-x64.zip).Hash -eq (Get-Content .\checksums.txt | Select-String "windows-x64.zip")
    ```
    
    **å®Œæ•´æ›´æ–°æ—¥å¿—**: [CHANGELOG.md](https://github.com/gpd-touch/gpd-touch-fix/blob/main/CHANGELOG.md)

# å‘å¸ƒå‰éªŒè¯
announce:
  skip: '{{gt .Patch 0}}'  # è·³è¿‡è¡¥ä¸ç‰ˆæœ¬çš„å…¬å‘Š

# å…ƒæ•°æ®
metadata:
  mod_timestamp: '{{ .CommitTimestamp }}'
